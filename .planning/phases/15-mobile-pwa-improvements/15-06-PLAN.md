---
phase: 15-mobile-pwa-improvements
plan: 06
type: execute
wave: 4
depends_on: ["15-03", "15-04", "15-05"]
files_modified:
  - src/components/equipment/equipment-card.tsx
  - src/components/calendar/practice-card.tsx
  - src/app/(dashboard)/[teamSlug]/equipment/page.tsx
  - src/app/(dashboard)/[teamSlug]/schedule/page.tsx
autonomous: false

must_haves:
  truths:
    - "Practice cards support swipe left to delete, swipe right to edit"
    - "Equipment cards support swipe left to delete, swipe right to edit"
    - "Swipe actions trigger appropriate dialogs/navigation"
    - "All mobile features work together without conflicts"
  artifacts:
    - path: "src/components/equipment/equipment-card.tsx"
      provides: "Equipment card with swipe support on mobile"
      contains: "SwipeableListItem"
    - path: "src/components/calendar/practice-card.tsx"
      provides: "Practice card with swipe support on mobile"
      contains: "SwipeableListItem"
  key_links:
    - from: "src/components/equipment/equipment-card.tsx"
      to: "src/components/mobile/swipeable-list-item.tsx"
      via: "import SwipeableListItem"
      pattern: "SwipeableListItem"
    - from: "src/components/calendar/practice-card.tsx"
      to: "src/components/mobile/swipeable-list-item.tsx"
      via: "import SwipeableListItem"
      pattern: "SwipeableListItem"
---

<objective>
Integrate all mobile components into the application and verify complete functionality.

Purpose: Connect the swipe gesture components, responsive menus, and PWA features into the actual app pages to deliver the complete mobile experience.
Output: Cards wrapped with swipe actions, menus converted to responsive, end-to-end verification.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/15-mobile-pwa-improvements/15-CONTEXT.md
@.planning/phases/15-mobile-pwa-improvements/15-RESEARCH.md
@src/components/mobile/swipeable-list-item.tsx (from 15-03)
@src/components/mobile/responsive-menu.tsx (from 15-04)
@src/components/equipment/equipment-card.tsx
@src/components/calendar/practice-card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add swipe gestures to EquipmentCard</name>
  <files>src/components/equipment/equipment-card.tsx</files>
  <action>
    Wrap EquipmentCard with SwipeableListItem for mobile swipe-to-action support.

    Changes:
    1. Import SwipeableListItem from '@/components/mobile/swipeable-list-item'
    2. Add new props for swipe actions:
       - onEdit?: () => void
       - onDelete?: () => void
    3. Wrap the card content with SwipeableListItem

    Updated component structure:
    ```tsx
    interface EquipmentCardProps {
      // ... existing props
      onEdit?: () => void;
      onDelete?: () => void;
    }

    export function EquipmentCard({
      // ... existing props
      onEdit,
      onDelete,
    }: EquipmentCardProps) {
      return (
        <SwipeableListItem
          onSwipeLeft={onDelete}
          onSwipeRight={onEdit}
          disabled={!isCoach}  // Only coaches can swipe
        >
          <div className="bg-zinc-800 rounded-lg border border-zinc-700 p-4 hover:border-zinc-600 transition-colors">
            {/* existing card content */}
          </div>
        </SwipeableListItem>
      );
    }
    ```

    Important: Keep the existing Link behavior for the card itself. The swipe actions are separate from the card click.

    Swipe should only be enabled when isCoach is true (athletes can't edit/delete).
  </action>
  <verify>EquipmentCard imports SwipeableListItem and wraps content</verify>
  <done>EquipmentCard supports swipe gestures on mobile for coaches</done>
</task>

<task type="auto">
  <name>Task 2: Add swipe gestures to PracticeCard</name>
  <files>src/components/calendar/practice-card.tsx</files>
  <action>
    Wrap PracticeCard with SwipeableListItem for mobile swipe-to-action support.

    Changes:
    1. Import SwipeableListItem from '@/components/mobile/swipeable-list-item'
    2. Add new props for swipe actions:
       - onEdit?: () => void
       - onDelete?: () => void
       - canEdit?: boolean (defaults to false - parent determines if user can edit)
    3. Wrap the card content with SwipeableListItem

    Updated component structure:
    ```tsx
    interface PracticeCardProps {
      // ... existing props
      onEdit?: () => void;
      onDelete?: () => void;
      canEdit?: boolean;
    }

    export function PracticeCard({
      // ... existing props
      onEdit,
      onDelete,
      canEdit = false,
    }: PracticeCardProps) {
      return (
        <SwipeableListItem
          onSwipeLeft={onDelete}
          onSwipeRight={onEdit}
          disabled={!canEdit}
        >
          <Link href={...} className="block p-3 rounded-lg border transition-colors ...">
            {/* existing card content */}
          </Link>
        </SwipeableListItem>
      );
    }
    ```

    Keep the existing Link wrapper inside SwipeableListItem so tap still navigates to practice detail.
  </action>
  <verify>PracticeCard imports SwipeableListItem and wraps content</verify>
  <done>PracticeCard supports swipe gestures on mobile when canEdit is true</done>
</task>

<task type="auto">
  <name>Task 3: Wire up swipe handlers in equipment page</name>
  <files>src/app/(dashboard)/[teamSlug]/equipment/page.tsx</files>
  <action>
    Update the equipment list page to pass swipe handlers to EquipmentCard.

    Find where EquipmentCard is rendered and add handlers:
    ```tsx
    <EquipmentCard
      key={equipment.id}
      {...existingProps}
      onEdit={() => router.push(`/${teamSlug}/equipment/${equipment.id}/edit`)}
      onDelete={() => {
        // Show confirmation dialog, then delete
        // Use existing delete logic or create new
        setDeleteTarget(equipment.id);
        setShowDeleteDialog(true);
      }}
    />
    ```

    If no delete confirmation dialog exists, add one:
    1. Add state: deleteTarget, showDeleteDialog
    2. Add Dialog component for delete confirmation
    3. On confirm, call delete API and refresh list

    The delete flow from CONTEXT.md Decision 4:
    - "All destructive swipes require confirmation dialog"
    - Use the shadcn Dialog component for confirmation
  </action>
  <verify>Equipment page passes onEdit and onDelete to cards</verify>
  <done>Equipment page has working swipe handlers with delete confirmation</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete mobile PWA improvements:
    - Network status indicator in header
    - Swipeable list items (equipment and practice cards)
    - Responsive menus (dropdown on desktop, bottom sheet on mobile)
    - PWA install prompt with iOS instructions
    - View transitions enabled
  </what-built>
  <how-to-verify>
    Test on mobile viewport (320px-414px) in Chrome DevTools:

    1. **Network indicator test:**
       - Go to Network tab, toggle "Offline" mode
       - Verify amber "Offline" indicator appears in header
       - Make a change while offline (if possible)
       - Go back online, verify sync indicator shows pending/syncing

    2. **Swipe gesture test:**
       - Navigate to equipment list
       - On mobile viewport, swipe a card left - verify red delete action appears
       - Swipe right - verify blue edit action appears
       - Complete swipe left - verify delete confirmation dialog
       - Verify vertical scroll still works while swiping
       - On desktop viewport (1024px+), verify no swipe functionality

    3. **Bottom sheet test:**
       - Find a context menu (three-dot menu) on mobile
       - Tap it - verify it opens as bottom sheet from bottom
       - Verify drag handle at top
       - Swipe down or tap backdrop to dismiss
       - On desktop, verify same menu opens as dropdown

    4. **PWA install test (if not already installed):**
       - On Android Chrome: Look for install banner at bottom
       - On iOS Safari: Verify shows manual "Add to Home Screen" instructions

    5. **View transitions test:**
       - Navigate between pages
       - Verify smooth cross-fade transition (subtle, not jarring)

    6. **Responsive layout test:**
       - Test at 320px, 375px, and 414px widths
       - Verify no horizontal scroll
       - Verify cards and content fit properly
  </how-to-verify>
  <resume-signal>Type "approved" if all mobile features work correctly, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. Equipment cards have swipe gestures on mobile
2. Practice cards have swipe gestures on mobile
3. Delete confirmation dialog appears after swipe-to-delete
4. Network indicator shows correct states
5. Responsive menus work on both mobile and desktop
6. PWA install prompt shows appropriate UI for platform
7. All features work together without conflicts
</verification>

<success_criteria>
- Swipe left on cards reveals delete action (with confirmation)
- Swipe right on cards triggers edit navigation
- Network indicator visible only when offline/syncing/pending
- Menus adapt to viewport (drawer on mobile, dropdown on desktop)
- iOS users see manual install instructions
- View transitions provide smooth page navigation
- All pages render correctly at mobile breakpoints (320px, 375px, 414px)
</success_criteria>

<output>
After completion, create `.planning/phases/15-mobile-pwa-improvements/15-06-SUMMARY.md`
</output>
