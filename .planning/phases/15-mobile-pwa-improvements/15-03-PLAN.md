---
phase: 15-mobile-pwa-improvements
plan: 03
type: execute
wave: 2
depends_on: ["15-01"]
files_modified:
  - src/hooks/use-swipe-gesture.ts
  - src/components/mobile/swipeable-list-item.tsx
autonomous: true

must_haves:
  truths:
    - "Swipe left on list item reveals delete action"
    - "Swipe right on list item reveals edit action"
    - "Swipe gesture does not interfere with vertical scrolling"
    - "Swipe snaps back when released without completing gesture"
  artifacts:
    - path: "src/hooks/use-swipe-gesture.ts"
      provides: "Reusable swipe gesture hook wrapping @use-gesture/react"
      exports: ["useSwipeGesture"]
    - path: "src/components/mobile/swipeable-list-item.tsx"
      provides: "Generic swipeable list item wrapper component"
      exports: ["SwipeableListItem"]
  key_links:
    - from: "src/hooks/use-swipe-gesture.ts"
      to: "@use-gesture/react"
      via: "import useDrag"
      pattern: "from ['\"]@use-gesture/react['\"]"
    - from: "src/components/mobile/swipeable-list-item.tsx"
      to: "src/hooks/use-swipe-gesture.ts"
      via: "import useSwipeGesture"
      pattern: "useSwipeGesture"
---

<objective>
Create swipeable list item infrastructure for mobile touch interactions.

Purpose: Mobile users expect swipe-to-reveal actions on list items (swipe left to delete, swipe right to edit). This provides a consistent gesture pattern across all list views.
Output: useSwipeGesture hook and SwipeableListItem component ready for integration with card components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/15-mobile-pwa-improvements/15-CONTEXT.md
@.planning/phases/15-mobile-pwa-improvements/15-RESEARCH.md
@src/components/equipment/equipment-card.tsx (example card to wrap)
@src/components/calendar/practice-card.tsx (example card to wrap)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useSwipeGesture hook</name>
  <files>src/hooks/use-swipe-gesture.ts</files>
  <action>
    Create a reusable hook wrapping @use-gesture/react's useDrag for horizontal swipe gestures.

    The hook should:
    1. Import useDrag from @use-gesture/react
    2. Track x offset state (how far the item has been dragged)
    3. Detect swipe completion (velocity + distance thresholds)
    4. Call onSwipeLeft or onSwipeRight callbacks when swipe completes
    5. Animate back to center when released without completing swipe
    6. Prevent interference with vertical scrolling (use axis: 'x')

    Interface:
    ```typescript
    interface UseSwipeGestureOptions {
      onSwipeLeft?: () => void;
      onSwipeRight?: () => void;
      swipeThreshold?: number;  // min distance in px, default 80
      velocityThreshold?: number; // min velocity, default 0.3
      disabled?: boolean;
    }

    interface UseSwipeGestureReturn {
      bind: ReturnType<typeof useDrag>;
      x: number;  // current x offset for styling
      isSwiping: boolean;
      swipeDirection: 'left' | 'right' | null;
    }
    ```

    Implementation notes:
    - Use requestAnimationFrame for smooth animation back to center (not react-spring)
    - Set bounds: { left: -120, right: 120 } to limit drag distance
    - Use rubberband: true for elastic feel at bounds
    - Set touch-action: 'pan-y' via CSS to allow vertical scroll

    Swipe detection logic:
    - On drag end, check if |movement[0]| > swipeThreshold OR velocity[0] > velocityThreshold
    - If movement[0] < 0 (dragged left): call onSwipeLeft
    - If movement[0] > 0 (dragged right): call onSwipeRight
    - After callback, animate x back to 0

    Export as named export: `export function useSwipeGesture()`
  </action>
  <verify>TypeScript compiles without errors</verify>
  <done>useSwipeGesture hook provides drag binding, x offset, and calls swipe callbacks</done>
</task>

<task type="auto">
  <name>Task 2: Create SwipeableListItem component</name>
  <files>src/components/mobile/swipeable-list-item.tsx</files>
  <action>
    Create the src/components/mobile directory and the SwipeableListItem component.

    The component should:
    1. Wrap children in a swipeable container
    2. Show action backgrounds behind content when swiped
    3. Use useSwipeGesture hook internally
    4. Only enable on mobile (check window width or use CSS media query)

    Props interface:
    ```typescript
    interface SwipeableListItemProps {
      children: React.ReactNode;
      onSwipeLeft?: () => void;   // Called when swipe left completes (delete)
      onSwipeRight?: () => void;  // Called when swipe right completes (edit)
      leftLabel?: string;         // Default: "Delete"
      rightLabel?: string;        // Default: "Edit"
      leftIcon?: React.ReactNode;
      rightIcon?: React.ReactNode;
      disabled?: boolean;
      className?: string;
    }
    ```

    Visual structure:
    ```
    <div className="relative overflow-hidden">
      <!-- Right action (revealed on swipe left) -->
      <div className="absolute inset-y-0 right-0 w-24 bg-red-500 flex items-center justify-center">
        <Trash2 icon + "Delete" text>
      </div>

      <!-- Left action (revealed on swipe right) -->
      <div className="absolute inset-y-0 left-0 w-24 bg-blue-500 flex items-center justify-center">
        <Pencil icon + "Edit" text>
      </div>

      <!-- Swipeable content -->
      <div style={{ transform: `translateX(${x}px)` }} {...bind()}>
        {children}
      </div>
    </div>
    ```

    Mobile-only behavior:
    - Use a useMediaQuery hook or check window.innerWidth < 768
    - On desktop (>= 768px), render children directly without swipe functionality
    - This matches CONTEXT.md Decision 5 (mobile only <768px)

    Styling notes:
    - Use touch-action: pan-y on the swipeable div
    - Action backgrounds should use theme colors:
      - Delete: bg-red-500 text-white
      - Edit: bg-blue-500 text-white (or use theme's --team-primary)
    - Icons from lucide-react: Trash2, Pencil
    - Text should be text-sm font-medium

    Export as named export: `export function SwipeableListItem()`
  </action>
  <verify>Component renders and swipe gestures work on mobile viewport</verify>
  <done>SwipeableListItem wraps content with swipe-to-reveal actions on mobile</done>
</task>

</tasks>

<verification>
1. `cat src/hooks/use-swipe-gesture.ts` shows useSwipeGesture hook with useDrag
2. `cat src/components/mobile/swipeable-list-item.tsx` shows SwipeableListItem component
3. `npm run build` completes without errors
4. Manual test in mobile viewport (Chrome DevTools):
   - Swipe left reveals red delete action
   - Swipe right reveals blue edit action
   - Vertical scroll still works
   - Desktop viewport shows no swipe functionality
</verification>

<success_criteria>
- useSwipeGesture hook provides clean API for swipe detection
- SwipeableListItem shows action backgrounds on swipe
- Horizontal swipe does not block vertical scroll
- Swipe snaps back when released mid-gesture
- Mobile-only behavior (desktop renders children directly)
</success_criteria>

<output>
After completion, create `.planning/phases/15-mobile-pwa-improvements/15-03-SUMMARY.md`
</output>
