---
phase: 16-ui-ux-polish
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/forms/create-team-form.tsx
  - src/components/forms/invite-member-form.tsx
  - src/components/equipment/equipment-form.tsx
  - src/components/practices/practice-form.tsx
  - src/components/athletes/athlete-form.tsx
  - src/components/templates/template-form.tsx
autonomous: true

must_haves:
  truths:
    - "Forms validate on blur (when user leaves field)"
    - "Inline error messages appear below invalid fields"
    - "Errors clear when user starts correcting"
    - "Invalid fields have visual indicator (red border)"
  artifacts:
    - path: "src/components/forms/create-team-form.tsx"
      provides: "Team creation form with onTouched validation"
      contains: "mode: 'onTouched'"
    - path: "src/components/equipment/equipment-form.tsx"
      provides: "Equipment form with onTouched validation"
      contains: "mode: 'onTouched'"
  key_links:
    - from: "All form components"
      to: "react-hook-form useForm"
      via: "mode: 'onTouched'"
      pattern: "useForm.*mode.*onTouched"
---

<objective>
Enhance form validation with inline feedback using onTouched mode.

Purpose: UIX-05 requires immediate validation feedback without annoying users during typing. The onTouched mode validates on first blur, then on every change - providing the optimal balance of immediate feedback and non-intrusiveness.

Output: All major forms updated to use mode: 'onTouched' with inline error display and visual invalid state styling.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/16-ui-ux-polish/16-CONTEXT.md
@.planning/phases/16-ui-ux-polish/16-RESEARCH.md

Reference existing form patterns:
@src/components/forms/create-team-form.tsx
@src/components/equipment/equipment-form.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FormField helper component for consistent validation display</name>
  <files>
    src/components/ui/form-field.tsx
  </files>
  <action>
Create a FormField wrapper component that provides consistent error display:

```tsx
// src/components/ui/form-field.tsx
'use client';

import { cn } from '@/lib/utils';
import type { FieldError } from 'react-hook-form';

interface FormFieldProps {
  label: string;
  htmlFor: string;
  error?: FieldError;
  required?: boolean;
  hint?: string;
  children: React.ReactNode;
  className?: string;
}

export function FormField({
  label,
  htmlFor,
  error,
  required,
  hint,
  children,
  className,
}: FormFieldProps) {
  return (
    <div className={cn('space-y-1.5', className)}>
      <label
        htmlFor={htmlFor}
        className="block text-sm font-medium text-zinc-200"
      >
        {label}
        {required && <span className="text-red-400 ml-1">*</span>}
      </label>
      {children}
      {hint && !error && (
        <p className="text-xs text-zinc-500">{hint}</p>
      )}
      {error && (
        <p className="text-sm text-red-400 animate-in fade-in slide-in-from-top-1 duration-200">
          {error.message}
        </p>
      )}
    </div>
  );
}
```

This component:
- Wraps label and input with consistent spacing
- Shows required indicator when needed
- Displays hint text when no error
- Animates error message appearance with tw-animate-css
- Uses consistent color scheme (zinc-200 label, red-400 errors)
  </action>
  <verify>
    - `cat src/components/ui/form-field.tsx` shows FormField component
    - `pnpm tsc --noEmit` passes
  </verify>
  <done>
    FormField component created with animated error display, hint support, and required indicator.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update create-team-form and invite-member-form with onTouched validation</name>
  <files>
    src/components/forms/create-team-form.tsx
    src/components/forms/invite-member-form.tsx
  </files>
  <action>
Update forms to use mode: 'onTouched' and FormField component:

1. **create-team-form.tsx:**
   - Add to useForm config: `mode: 'onTouched', reValidateMode: 'onChange'`
   - Import FormField from '@/components/ui/form-field'
   - Replace manual label/input/error with FormField wrapper
   - Add aria-invalid to inputs: `aria-invalid={!!errors.name}`
   - Add invalid styling to inputs: `className={cn(baseInputClasses, errors.name && 'border-red-500 focus:border-red-500 focus:ring-red-500/20')}`
   - Keep the submit error div but move API errors to toast (from Plan 02)

   Before:
   ```tsx
   <div>
     <label htmlFor="name" className="...">Team Name</label>
     <input {...register('name')} className="..." />
     {errors.name && <p className="...">{errors.name.message}</p>}
   </div>
   ```

   After:
   ```tsx
   <FormField label="Team Name" htmlFor="name" error={errors.name} required>
     <input
       type="text"
       id="name"
       {...register('name')}
       aria-invalid={!!errors.name}
       className={cn(inputClasses, errors.name && 'border-red-500')}
       placeholder="Enter your team name"
     />
   </FormField>
   ```

2. **invite-member-form.tsx:**
   - Same pattern: add mode: 'onTouched', reValidateMode: 'onChange'
   - Wrap fields with FormField
   - Add aria-invalid and invalid border styling
  </action>
  <verify>
    - `grep -n "mode: 'onTouched'" src/components/forms/create-team-form.tsx` shows config
    - `grep -n "mode: 'onTouched'" src/components/forms/invite-member-form.tsx` shows config
    - `pnpm tsc --noEmit` passes
    - Manual: Tab through form fields to verify validation triggers on blur
  </verify>
  <done>
    Team and invite forms use onTouched validation with FormField wrapper and visual invalid states.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update equipment, practice, athlete, and template forms</name>
  <files>
    src/components/equipment/equipment-form.tsx
    src/components/practices/practice-form.tsx
    src/components/athletes/athlete-form.tsx
    src/components/templates/template-form.tsx
  </files>
  <action>
Apply the same pattern to remaining forms:

1. **equipment-form.tsx:**
   - Add mode: 'onTouched', reValidateMode: 'onChange' to useForm
   - Wrap field groups with FormField where appropriate
   - Add aria-invalid and error border styling
   - Focus on name, manufacturer, serialNumber fields (text inputs)

2. **practice-form.tsx:**
   - Add mode: 'onTouched', reValidateMode: 'onChange'
   - Practice name, date/time fields with FormField wrapper
   - Validate required fields on blur

3. **athlete-form.tsx:**
   - Add mode: 'onTouched', reValidateMode: 'onChange'
   - Display name, phone fields with FormField
   - Preferences dropdowns may not need FormField (less likely to have errors)

4. **template-form.tsx:**
   - Add mode: 'onTouched', reValidateMode: 'onChange'
   - Template name with FormField wrapper

For each form:
- Import FormField if using text inputs
- Add mode config to useForm
- Add aria-invalid to inputs with errors
- Add conditional border-red-500 class for invalid inputs
- Keep select/dropdown fields with their existing validation (less common to be invalid)
  </action>
  <verify>
    - `grep -rn "mode: 'onTouched'" src/components/` shows all 6 forms updated
    - `pnpm tsc --noEmit` passes
    - Manual: Test each form by blurring from required fields without entering data
  </verify>
  <done>
    All major forms use mode: 'onTouched' with inline error display. Forms validate on blur and show animated error messages with red border indicators.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `pnpm tsc --noEmit`
2. All 6 forms have mode: 'onTouched' in useForm config
3. FormField component provides consistent error animation
4. Invalid inputs show red border styling
5. Manual: Blur from required fields triggers validation
6. Manual: Typing in invalid field clears error on change
</verification>

<success_criteria>
- FormField component available for consistent validation display
- All 6 major forms use mode: 'onTouched' validation
- Inline error messages animate in below invalid fields
- Invalid fields have red border visual indicator
- Errors clear when user starts typing (reValidateMode: 'onChange')
- aria-invalid attribute set for accessibility
</success_criteria>

<output>
After completion, create `.planning/phases/16-ui-ux-polish/16-03-SUMMARY.md`
</output>
