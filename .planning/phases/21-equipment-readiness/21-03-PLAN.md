---
phase: 21-equipment-readiness
plan: 03
type: execute
wave: 2
depends_on: ["21-01"]
files_modified:
  - src/components/equipment/readiness-badge.tsx
autonomous: true

must_haves:
  truths:
    - "Badge displays correct color for each status (green/yellow/amber/red)"
    - "Badge shows status icon and label"
    - "Badge component is reusable across pages"
  artifacts:
    - path: "src/components/equipment/readiness-badge.tsx"
      provides: "ReadinessBadge component with CVA variants"
      exports: ["ReadinessBadge", "readinessBadgeVariants"]
      min_lines: 40
  key_links:
    - from: "src/components/equipment/readiness-badge.tsx"
      to: "src/lib/equipment/readiness.ts"
      via: "ReadinessStatus type import"
      pattern: "import.*ReadinessStatus"
---

<objective>
Create the ReadinessBadge component using the class-variance-authority pattern.

Purpose: Provide consistent visual indicator for equipment readiness status across list pages, detail pages, and dashboard widget with traffic light color coding.

Output: ReadinessBadge component with CVA variants for READY (green), INSPECT_SOON (yellow), NEEDS_ATTENTION (amber), OUT_OF_SERVICE (red).
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-equipment-readiness/21-CONTEXT.md
@.planning/phases/21-equipment-readiness/21-RESEARCH.md
@src/components/announcements/announcement-priority-badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ReadinessBadge component with CVA variants</name>
  <files>src/components/equipment/readiness-badge.tsx</files>
  <action>
Create the badge component following the exact pattern from announcement-priority-badge.tsx:

```typescript
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"
import { CheckCircle2, Clock, AlertTriangle, XCircle } from "lucide-react"
import { cn } from "@/lib/utils"
import type { ReadinessStatus } from "@/lib/equipment/readiness"

/**
 * CVA variants for readiness badge styling.
 * Traffic light colors: green (ready), yellow (soon), amber (attention), red (out).
 */
const readinessBadgeVariants = cva(
  "inline-flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium",
  {
    variants: {
      status: {
        READY: "bg-emerald-500/15 text-emerald-400 border border-emerald-500/20",
        INSPECT_SOON: "bg-yellow-500/15 text-yellow-400 border border-yellow-500/20",
        NEEDS_ATTENTION: "bg-amber-500/15 text-amber-400 border border-amber-500/20",
        OUT_OF_SERVICE: "bg-red-500/15 text-red-400 border border-red-500/20",
      },
    },
    defaultVariants: {
      status: "READY",
    },
  }
)

/**
 * Icons for each readiness status.
 */
const statusIcons = {
  READY: CheckCircle2,
  INSPECT_SOON: Clock,
  NEEDS_ATTENTION: AlertTriangle,
  OUT_OF_SERVICE: XCircle,
} as const

/**
 * Human-readable labels for each status.
 */
const statusLabels: Record<ReadinessStatus, string> = {
  READY: "Ready",
  INSPECT_SOON: "Inspect Soon",
  NEEDS_ATTENTION: "Needs Attention",
  OUT_OF_SERVICE: "Out of Service",
}

interface ReadinessBadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof readinessBadgeVariants> {
  /** Show icon alongside label. Default: true */
  showIcon?: boolean
  /** Show label text. Default: true (set false for icon-only compact mode) */
  showLabel?: boolean
}

/**
 * Equipment readiness status badge with traffic light colors.
 *
 * Usage:
 * ```tsx
 * <ReadinessBadge status="READY" />
 * <ReadinessBadge status="NEEDS_ATTENTION" showIcon={false} />
 * <ReadinessBadge status="OUT_OF_SERVICE" showLabel={false} /> // icon only
 * ```
 */
function ReadinessBadge({
  status = "READY",
  showIcon = true,
  showLabel = true,
  className,
  ...props
}: ReadinessBadgeProps) {
  const Icon = statusIcons[status as ReadinessStatus] || CheckCircle2
  const label = statusLabels[status as ReadinessStatus] || status

  return (
    <div
      className={cn(readinessBadgeVariants({ status, className }))}
      {...props}
    >
      {showIcon && <Icon className="h-3 w-3" />}
      {showLabel && <span>{label}</span>}
    </div>
  )
}

export { ReadinessBadge, readinessBadgeVariants }
```

Color mapping from CONTEXT.md:
- READY: green (emerald-500) - equipment is good to use
- INSPECT_SOON: yellow (yellow-500) - inspection due within threshold
- NEEDS_ATTENTION: amber (amber-500) - overdue or moderate damage
- OUT_OF_SERVICE: red (red-500) - cannot use (critical damage, never inspected, or manual override)
  </action>
  <verify>grep -n "readinessBadgeVariants\|ReadinessBadge" src/components/equipment/readiness-badge.tsx shows component and variants</verify>
  <done>ReadinessBadge component created with CVA variants for all 4 statuses</done>
</task>

<task type="auto">
  <name>Task 2: Verify TypeScript compilation and exports</name>
  <files>src/components/equipment/readiness-badge.tsx</files>
  <action>
Verify the component compiles and exports correctly:

1. Run TypeScript check:
   ```bash
   npx tsc --noEmit src/components/equipment/readiness-badge.tsx
   ```

2. Verify imports work:
   - ReadinessStatus type from @/lib/equipment/readiness
   - cva from class-variance-authority
   - cn from @/lib/utils
   - Icons from lucide-react

3. Test that the export statement is correct:
   ```bash
   grep "export { ReadinessBadge" src/components/equipment/readiness-badge.tsx
   ```

If any type errors occur, fix them:
- Ensure ReadinessStatus is exported from readiness.ts (should be from Plan 02)
- Ensure VariantProps generic parameter matches the variant definition
  </action>
  <verify>npx tsc --noEmit && grep "export { ReadinessBadge" src/components/equipment/readiness-badge.tsx</verify>
  <done>Component compiles without TypeScript errors and exports both ReadinessBadge and readinessBadgeVariants</done>
</task>

</tasks>

<verification>
1. File exists: `ls src/components/equipment/readiness-badge.tsx`
2. CVA pattern: `grep "cva(" src/components/equipment/readiness-badge.tsx`
3. All 4 statuses defined: `grep -E "READY|INSPECT_SOON|NEEDS_ATTENTION|OUT_OF_SERVICE" src/components/equipment/readiness-badge.tsx`
4. Type import: `grep "ReadinessStatus" src/components/equipment/readiness-badge.tsx`
5. TypeScript: `npx tsc --noEmit` passes
</verification>

<success_criteria>
- ReadinessBadge component exported from src/components/equipment/readiness-badge.tsx
- readinessBadgeVariants exported for potential external use
- CVA variants defined for READY (emerald), INSPECT_SOON (yellow), NEEDS_ATTENTION (amber), OUT_OF_SERVICE (red)
- Icons: CheckCircle2, Clock, AlertTriangle, XCircle for each status
- Human-readable labels: "Ready", "Inspect Soon", "Needs Attention", "Out of Service"
- showIcon and showLabel props for flexibility
- Component follows exact pattern of announcement-priority-badge.tsx
</success_criteria>

<output>
After completion, create `.planning/phases/21-equipment-readiness/21-03-SUMMARY.md`
</output>
