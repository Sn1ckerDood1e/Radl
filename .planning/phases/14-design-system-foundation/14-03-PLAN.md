---
phase: 14-design-system-foundation
plan: 03
type: execute
wave: 3
depends_on: ["14-02"]
files_modified:
  - src/components/ui/theme-toggle.tsx
  - src/components/layout/dashboard-header.tsx
  - src/app/(dashboard)/[teamSlug]/settings/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can toggle between light, dark, and system themes"
    - "Theme preference persists across page refreshes"
    - "Theme toggle visible in dashboard header"
    - "Theme selector available in settings page"
  artifacts:
    - path: "src/components/ui/theme-toggle.tsx"
      provides: "Theme toggle dropdown component"
      exports: ["ThemeToggle"]
    - path: "src/components/layout/dashboard-header.tsx"
      provides: "Header with theme toggle"
      contains: "ThemeToggle"
    - path: "src/app/(dashboard)/[teamSlug]/settings/page.tsx"
      provides: "Settings page with theme section"
      contains: "theme"
  key_links:
    - from: "src/components/ui/theme-toggle.tsx"
      to: "src/components/providers/theme-provider.tsx"
      via: "useTheme hook"
      pattern: "useTheme"
    - from: "src/components/ui/theme-toggle.tsx"
      to: "src/components/ui/dropdown-menu.tsx"
      via: "shadcn DropdownMenu"
      pattern: "DropdownMenu"
---

<objective>
Create theme toggle UI component and integrate into header and settings page.

Purpose: Allow users to switch between dark, light, and system themes.
Output: ThemeToggle component using shadcn DropdownMenu, integrated in header and settings.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase-specific context
@.planning/phases/14-design-system-foundation/14-CONTEXT.md
@.planning/phases/14-design-system-foundation/14-RESEARCH.md

# Prior plan summaries
@.planning/phases/14-design-system-foundation/14-01-SUMMARY.md
@.planning/phases/14-design-system-foundation/14-02-SUMMARY.md

# Existing components
@src/components/providers/theme-provider.tsx
@src/components/layout/dashboard-header.tsx
@src/components/ui/dropdown-menu.tsx
@src/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ThemeToggle component</name>
  <files>src/components/ui/theme-toggle.tsx</files>
  <action>
Create src/components/ui/theme-toggle.tsx:

```tsx
'use client';

import { Moon, Sun, Monitor } from 'lucide-react';
import { Button } from '@/components/ui/button';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { useTheme } from '@/components/providers/theme-provider';

export function ThemeToggle() {
  const { theme, setTheme, resolvedTheme } = useTheme();

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="icon" className="h-9 w-9">
          <Sun className="h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
          <Moon className="absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
          <span className="sr-only">Toggle theme</span>
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <DropdownMenuItem
          onClick={() => setTheme('light')}
          className={theme === 'light' ? 'bg-accent' : ''}
        >
          <Sun className="mr-2 h-4 w-4" />
          Light
        </DropdownMenuItem>
        <DropdownMenuItem
          onClick={() => setTheme('dark')}
          className={theme === 'dark' ? 'bg-accent' : ''}
        >
          <Moon className="mr-2 h-4 w-4" />
          Dark
        </DropdownMenuItem>
        <DropdownMenuItem
          onClick={() => setTheme('system')}
          className={theme === 'system' ? 'bg-accent' : ''}
        >
          <Monitor className="mr-2 h-4 w-4" />
          System
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
```

Uses:
- shadcn Button with ghost variant and icon size
- shadcn DropdownMenu for theme selection
- Existing useTheme hook from theme-provider
- lucide-react icons (already installed)
- Sun/Moon transition animation using Tailwind dark: modifier
  </action>
  <verify>
- File exists with 'use client' directive
- Imports useTheme from @/components/providers/theme-provider
- Uses shadcn DropdownMenu and Button components
- Has sr-only screen reader label
  </verify>
  <done>ThemeToggle component created with accessibility and animations</done>
</task>

<task type="auto">
  <name>Task 2: Add ThemeToggle to dashboard header</name>
  <files>src/components/layout/dashboard-header.tsx</files>
  <action>
Update src/components/layout/dashboard-header.tsx to include ThemeToggle.

Add import at top:
```tsx
import { ThemeToggle } from '@/components/ui/theme-toggle';
```

In the header's right side div (around line 110-113), add ThemeToggle before SyncStatus:
```tsx
{/* Right side - Theme + Sync Status + Notifications */}
<div className="flex items-center gap-4">
  <ThemeToggle />
  <SyncStatus />
  {currentSlug && <NotificationBell teamSlug={currentSlug} />}
</div>
```

Position ThemeToggle first so the more dynamic elements (sync status, notifications) are rightmost.
  </action>
  <verify>
- ThemeToggle imported at top of file
- ThemeToggle component rendered in header right section
- Order is: ThemeToggle, SyncStatus, NotificationBell
  </verify>
  <done>ThemeToggle visible in dashboard header</done>
</task>

<task type="auto">
  <name>Task 3: Add theme section to settings page</name>
  <files>src/app/(dashboard)/[teamSlug]/settings/page.tsx</files>
  <action>
Update the settings page to include a Theme section.

First read the current settings page structure, then add a Theme section.

Add a Theme Settings card/section with:
- Title: "Theme"
- Description: "Choose your preferred color scheme"
- Three radio-style options or select for: Light, Dark, System
- Use shadcn Select component for the selector

Example implementation:
```tsx
'use client';

import { useTheme } from '@/components/providers/theme-provider';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';

// Inside the page component, add a Theme section:
function ThemeSection() {
  const { theme, setTheme } = useTheme();

  return (
    <div className="bg-[var(--surface-2)] rounded-lg p-6 border border-[var(--border-subtle)]">
      <h3 className="text-lg font-medium text-[var(--text-primary)] mb-2">
        Theme
      </h3>
      <p className="text-sm text-[var(--text-muted)] mb-4">
        Choose your preferred color scheme
      </p>
      <Select value={theme} onValueChange={(value) => setTheme(value as 'light' | 'dark' | 'system')}>
        <SelectTrigger className="w-[200px]">
          <SelectValue placeholder="Select theme" />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="light">Light</SelectItem>
          <SelectItem value="dark">Dark</SelectItem>
          <SelectItem value="system">System</SelectItem>
        </SelectContent>
      </Select>
    </div>
  );
}
```

Place this section near the top of the settings page, before Security sections.

NOTE: The settings page may already have multiple sections. Match the existing styling patterns. If the page is not a client component, add 'use client' or extract the theme section to a separate client component and import it.
  </action>
  <verify>
- Settings page has Theme section visible
- Select shows current theme (light/dark/system)
- Changing selection updates theme immediately
- Theme persists after page refresh
  </verify>
  <done>Theme selector available in settings page</done>
</task>

</tasks>

<verification>
- [ ] src/components/ui/theme-toggle.tsx exists with ThemeToggle export
- [ ] ThemeToggle uses shadcn DropdownMenu
- [ ] Dashboard header shows theme toggle icon
- [ ] Clicking toggle shows Light/Dark/System options
- [ ] Settings page has Theme section with Select
- [ ] Theme changes apply immediately
- [ ] Theme preference persists across refresh (localStorage)
</verification>

<success_criteria>
Theme toggle visible in header dropdown. Full theme selector in settings page. Both use shadcn components. Theme changes apply immediately and persist across sessions.
</success_criteria>

<output>
After completion, create `.planning/phases/14-design-system-foundation/14-03-SUMMARY.md`
</output>
