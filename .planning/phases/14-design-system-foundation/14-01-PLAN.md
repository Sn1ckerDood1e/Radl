---
phase: 14-design-system-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/globals.css
  - components.json
  - package.json
autonomous: true

must_haves:
  truths:
    - "shadcn/ui CLI initializes successfully"
    - "Existing theme variables preserved and working"
    - "shadcn components can use mapped CSS variables"
  artifacts:
    - path: "components.json"
      provides: "shadcn/ui configuration"
      contains: "tailwind"
    - path: "src/app/globals.css"
      provides: "CSS variable mapping to shadcn namespace"
      contains: "@theme inline"
    - path: "src/lib/utils.ts"
      provides: "cn() utility function"
      exports: ["cn"]
  key_links:
    - from: "src/app/globals.css"
      to: "@theme inline"
      via: "CSS variable mapping"
      pattern: "--color-background.*var\\(--background\\)"
---

<objective>
Initialize shadcn/ui with Tailwind v4 configuration and map existing CSS variables.

Purpose: Establish the design system foundation that shadcn/ui components will use.
Output: components.json config, updated globals.css with CSS variable mapping, cn() utility.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase-specific context
@.planning/phases/14-design-system-foundation/14-CONTEXT.md
@.planning/phases/14-design-system-foundation/14-RESEARCH.md

# Current implementation files
@src/app/globals.css
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize shadcn/ui</name>
  <files>components.json, src/lib/utils.ts, package.json</files>
  <action>
Run shadcn/ui initialization:
```bash
npx shadcn@latest init
```

When prompted, select:
- Style: new-york (compact, modern - default style is deprecated)
- Base color: zinc (matches existing palette)
- CSS variables: yes
- React Server Components: yes
- Tailwind CSS config: use default (CSS-first config)
- Components alias: @/components
- Utils alias: @/lib/utils
- Import alias: @/

The CLI will:
1. Create components.json with configuration
2. Create src/lib/utils.ts with cn() utility (uses clsx + tailwind-merge)
3. Install dependencies: class-variance-authority, clsx, tailwind-merge
4. Install tw-animate-css (replaces deprecated tailwindcss-animate for Tailwind v4)

IMPORTANT:
- Do NOT run with --defaults flag - use interactive mode to ensure correct settings
- If prompted about existing files, choose to keep/merge existing content
  </action>
  <verify>
- components.json exists with style: "new-york"
- src/lib/utils.ts exists with cn() function exported
- package.json includes class-variance-authority, clsx, tailwind-merge
- npm install completes successfully
  </verify>
  <done>shadcn/ui initialized with new-york style and zinc base color</done>
</task>

<task type="auto">
  <name>Task 2: Update globals.css with shadcn CSS variable mapping</name>
  <files>src/app/globals.css</files>
  <action>
Update src/app/globals.css to add CSS variable mapping to shadcn namespace.

KEEP all existing CSS unchanged. Add the tw-animate-css import and expand the @theme inline block.

At the top, after @import "tailwindcss":
```css
@import "tw-animate-css";
```

Expand the @theme inline block to include all shadcn variables:
```css
@theme inline {
  /* Existing mappings - keep */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);

  /* shadcn/ui component variables - add */
  --color-card: var(--surface-2);
  --color-card-foreground: var(--text-primary);
  --color-popover: var(--surface-2);
  --color-popover-foreground: var(--text-primary);
  --color-primary: var(--team-primary);
  --color-primary-foreground: #ffffff;
  --color-secondary: var(--surface-3);
  --color-secondary-foreground: var(--text-primary);
  --color-muted: var(--surface-3);
  --color-muted-foreground: var(--text-muted);
  --color-accent: var(--surface-3);
  --color-accent-foreground: var(--text-primary);
  --color-destructive: oklch(0.55 0.22 25);
  --color-destructive-foreground: #ffffff;
  --color-border: var(--border);
  --color-input: var(--border);
  --color-ring: var(--team-primary);

  /* Border radius */
  --radius: 0.5rem;
}
```

IMPORTANT:
- Keep ALL existing :root, .light, .dark CSS unchanged
- Keep ALL existing utility classes (.team-primary-bg, .theme-surface, etc.)
- Keep ALL existing form input dark mode styles
- Only ADD the tw-animate-css import and expand @theme inline
  </action>
  <verify>
- globals.css has @import "tw-animate-css" after @import "tailwindcss"
- @theme inline block includes --color-card, --color-primary, --color-destructive, --radius
- Existing :root variables still present (--surface-1, --surface-2, --surface-3)
- npm run build completes without CSS errors
  </verify>
  <done>CSS variables mapped to shadcn namespace, animations library imported</done>
</task>

<task type="auto">
  <name>Task 3: Verify theme switching still works</name>
  <files></files>
  <action>
Start dev server and verify:
1. Dark mode (default) applies correctly
2. Switching to light mode updates all surfaces
3. CSS variables resolve correctly in both themes

Test by:
```bash
npm run dev
```

Then manually check in browser:
- Open DevTools, verify CSS variables in :root
- Toggle between dark/light mode if toggle exists, or manually add/remove .light class on html element
- Verify surface colors change appropriately

If any issues:
- Check @theme inline has no syntax errors (no trailing commas, proper semicolons)
- Verify existing variables still exist unchanged in :root, .light, .dark blocks
  </action>
  <verify>
- npm run dev starts without errors
- Browser DevTools shows CSS variables resolving correctly
- Both dark and light themes render correctly
  </verify>
  <done>Theme switching preserved after shadcn initialization</done>
</task>

</tasks>

<verification>
- [ ] components.json exists with correct configuration
- [ ] src/lib/utils.ts exports cn() function
- [ ] globals.css has @import "tw-animate-css"
- [ ] globals.css @theme inline includes shadcn variables
- [ ] Existing CSS variables preserved (--surface-1, --team-primary, etc.)
- [ ] npm run build passes
- [ ] npm run dev shows no CSS-related errors
</verification>

<success_criteria>
shadcn/ui is initialized with Tailwind v4 configuration. CSS variables are mapped from existing theme to shadcn namespace. Build and dev commands work. Theme switching preserved.
</success_criteria>

<output>
After completion, create `.planning/phases/14-design-system-foundation/14-01-SUMMARY.md`
</output>
