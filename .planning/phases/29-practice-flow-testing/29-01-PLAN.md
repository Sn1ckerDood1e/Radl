---
phase: 29-practice-flow-testing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: false
requirements:
  - PRAC-01
  - PRAC-02
  - PRAC-03
  - PRAC-04
  - PRAC-05

must_haves:
  truths:
    - "Coach can create practice with date, time, name and see it on calendar"
    - "Coach can add water, erg, land, and meeting blocks to practice"
    - "Coach can drag athletes into lineup seats and assignments persist after save"
    - "Athletes see their boat assignment when practice is published"
    - "Calendar shows practices with green dots and draft/published styling"
  artifacts: []
  key_links: []
---

<objective>
Manual E2E verification of complete practice flow

Purpose: Verify all practice-related features work end-to-end. This phase tests the core value proposition: coaches can plan practices with lineups and athletes know where to be and what boat they're in.

Output: Verified working practice flow with documented test results.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-practice-flow-testing/29-RESEARCH.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify: Practice creation flow (PRAC-01)</name>
  <what-built>
Practice creation via bulk-create page with:
- Season selector (required)
- Practice name, date, start/end times
- Notes field (can be used for location info)
- Practice appears in list and calendar with DRAFT status
  </what-built>
  <how-to-verify>
**Prerequisites:**
- Logged in as COACH with an existing team
- At least one Season exists for the team

**Test Steps:**

1. Navigate to `/{teamSlug}/practices`
2. Click "New Practice" or navigate to `/{teamSlug}/practices/bulk-create`
3. Verify bulk practice creator form displays:
   - Season dropdown (required)
   - Practice name field
   - Date picker
   - Start time picker
   - End time picker
   - Notes field
4. Fill in the form:
   - Select an active season
   - Name: "Morning Row"
   - Date: tomorrow or any future date
   - Start: 6:00 AM
   - End: 8:00 AM
   - Notes: "Lake House dock" (use notes for location)
5. Submit the form
6. Verify redirect to practices list or practice detail
7. Check practices list:
   - Practice appears with "DRAFT" status badge
   - Date and time display correctly
8. Navigate to calendar view:
   - Find the date you selected
   - Verify green dot indicator on that day
   - Click the day
   - Verify practice card appears in sidebar
   - Card shows amber/yellow styling (draft)

**Expected Results:**
- [ ] Practice form displays all required fields
- [ ] Season is required (cannot submit without)
- [ ] Practice creates successfully
- [ ] Practice appears in list with DRAFT status
- [ ] Practice appears on calendar with green dot
- [ ] Calendar sidebar shows practice when day is clicked
- [ ] Draft practice has amber/yellow styling
  </how-to-verify>
  <resume-signal>Type "prac-01-passed" if all checks pass, or describe any issues found</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify: Block management (PRAC-02)</name>
  <what-built>
Block-based practice structure with:
- Four block types: WATER, ERG, LAND, MEETING
- Block type buttons for adding blocks
- Drag-drop reordering via @dnd-kit
- Inline editing for block fields
- Block deletion
  </what-built>
  <how-to-verify>
**Prerequisites:**
- Practice created from previous test (or create new one)
- Logged in as COACH

**Test Steps:**

1. Navigate to practice detail page: `/{teamSlug}/practices/{practiceId}`
2. Verify page loads with inline editing interface
3. Find the "Add Block" buttons section

**Add each block type:**

4. Click "Water" button
   - Verify water block appears
   - Block should have blue/water-themed styling
   - Shows "Lineups" section placeholder

5. Click "Erg" button
   - Verify erg block appears
   - Block should have different styling
   - May show workout builder UI

6. Click "Land" button
   - Verify land block appears
   - Block allows notes entry

7. Click "Meeting" button
   - Verify meeting block appears
   - Block allows notes entry

**Block operations:**

8. Edit a block title inline (click title, type new name)
9. Verify edit persists (may auto-save)

10. Drag a block to reorder:
    - Grab a block's drag handle
    - Move it above/below another block
    - Release
11. Verify new order appears

12. Refresh the page
13. Verify block order persisted

14. Delete a block:
    - Find delete button/icon on a block
    - Click to delete
    - Confirm if prompted
15. Verify block removed from list

**Expected Results:**
- [ ] Can add WATER block
- [ ] Can add ERG block
- [ ] Can add LAND block
- [ ] Can add MEETING block
- [ ] Each block type has distinct visual styling
- [ ] Can edit block title inline
- [ ] Can drag blocks to reorder
- [ ] Block order persists after refresh
- [ ] Can delete blocks
  </how-to-verify>
  <resume-signal>Type "prac-02-passed" if all checks pass, or describe any issues found</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify: Lineup drag-drop (PRAC-03)</name>
  <what-built>
Multi-boat lineup builder with:
- Draggable athlete cards from roster panel
- Droppable seat slots on boat diagrams
- Cross-boat swapping when dropping on occupied seat
- Persist lineups to database via API
- 8px activation distance prevents accidental drags
  </what-built>
  <how-to-verify>
**Prerequisites:**
- Practice with at least one WATER block (from previous test)
- Team has at least 4-6 athletes on roster
- Team has at least 2 boats/equipment defined
- Logged in as COACH

**Test Steps:**

1. Navigate to practice detail page
2. Scroll to the WATER block
3. Find "Lineups" section within the water block

**Add first boat:**

4. Click "Add Boat" or "Add Lineup" button
5. Select a boat from the picker (e.g., "Varsity 8+")
6. Verify boat diagram appears with empty seats
7. Verify athlete roster panel visible on side

**Assign athletes:**

8. Drag an athlete from roster to Seat 1 (stroke seat)
   - Note: requires 8px movement to activate drag
9. Verify athlete card appears in the seat
10. Verify athlete removed from roster panel

11. Drag another athlete to Seat 2
12. Verify assignment works

**Test swap behavior:**

13. Drag a third athlete to Seat 1 (already occupied)
14. Verify swap occurs:
    - New athlete takes Seat 1
    - Previous athlete returns to roster

**Multi-boat:**

15. Click "Add Boat" again
16. Select a different boat
17. Verify second boat diagram appears
18. Drag athlete from roster to second boat
19. Verify athlete appears in second boat's lineup

**Cross-boat swap (if supported):**

20. Try dragging athlete from Boat 1 to Boat 2 seat
21. Verify behavior (may swap or move)

**Save and verify persistence:**

22. Click "Save Lineups" button
23. Wait for success toast
24. Refresh the page (Ctrl+R / Cmd+R)
25. Verify lineups still show assigned athletes
26. Verify seats have correct athletes

**Expected Results:**
- [ ] Can add boat to water block
- [ ] Boat diagram shows numbered seats
- [ ] Athlete roster panel displays team athletes
- [ ] Drag requires ~8px movement to start
- [ ] Can drag athlete to empty seat
- [ ] Athlete removed from roster when assigned
- [ ] Can swap athletes by dragging to occupied seat
- [ ] Can add multiple boats
- [ ] Save button persists lineups
- [ ] Lineups persist after page refresh
  </how-to-verify>
  <resume-signal>Type "prac-03-passed" if all checks pass, or describe any issues found</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify: Publishing and athlete visibility (PRAC-04)</name>
  <what-built>
Practice publishing workflow with:
- Draft/Published toggle on practice detail
- Visibility filtering for athletes
- NextPracticeWidget showing athlete's assignment
- Athletes see lineup but cannot edit
  </what-built>
  <how-to-verify>
**Prerequisites:**
- Practice with complete lineups from previous test
- At least one athlete assigned to a seat
- Know the athlete's login credentials (or use second browser/incognito)
- Practice is currently in DRAFT status

**Coach Steps:**

1. As COACH: Navigate to practice detail
2. Verify status shows "Draft" (amber/yellow)
3. Find the publish toggle (button or switch)
4. Click to publish the practice
5. Verify status changes to "Published" (green)
6. Note which athlete is in which seat/boat

**Athlete View:**

7. Log in as an ATHLETE who is assigned to a seat
   - Use incognito window or different browser
   - Or sign out of coach account and sign in as athlete

8. Navigate to practices list: `/{teamSlug}/practices`
9. Verify the published practice appears
10. Verify any DRAFT practices do NOT appear

11. Click on the published practice to open detail
12. Verify practice page loads (not 404)
13. Verify athlete can see the lineup
14. Verify athlete sees their name in assigned seat
15. Verify athlete CANNOT edit lineups (read-only)

**Dashboard Widget:**

16. Navigate to team dashboard: `/{teamSlug}`
17. Look for "Next Practice" widget
18. Verify widget shows upcoming practice info:
    - Practice name and date/time
    - Boat assignment (e.g., "Varsity 8+")
    - Seat position (e.g., "Seat 4")
    - Side if applicable (port/starboard)

**Unpublish test:**

19. Switch back to COACH account
20. Unpublish the practice (toggle back to Draft)
21. Switch to ATHLETE account
22. Navigate to practices list
23. Verify the unpublished practice no longer appears
24. Try navigating directly to practice URL
25. Verify 404 or access denied

**Expected Results:**
- [ ] Coach can toggle practice from Draft to Published
- [ ] Published status shows green styling
- [ ] Athlete sees published practice in list
- [ ] Athlete does NOT see draft practices
- [ ] Athlete can view practice detail
- [ ] Athlete sees lineup with their assignment
- [ ] Athlete cannot edit lineups
- [ ] NextPracticeWidget shows athlete's assignment
- [ ] Widget shows boat name and seat position
- [ ] Unpublishing hides practice from athletes
  </how-to-verify>
  <resume-signal>Type "prac-04-passed" if all checks pass, or describe any issues found</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify: Calendar readability (PRAC-05)</name>
  <what-built>
UnifiedCalendar with react-day-picker featuring:
- Month navigation (prev/next)
- Green dots for practice days
- Blue dots/bars for regatta days
- Day selection showing events in sidebar
- Draft vs published visual distinction
- Season filter dropdown
- Mobile-responsive layout
  </what-built>
  <how-to-verify>
**Prerequisites:**
- Multiple practices across different dates
- At least one draft and one published practice
- (Optional) Regatta Central integration with regattas

**Test Steps:**

**Basic Calendar Navigation:**

1. Navigate to `/{teamSlug}/practices`
2. Switch to calendar view (may be default)
3. Verify current month displays with correct dates
4. Click left arrow to go to previous month
5. Verify month changes correctly
6. Click right arrow to go to next month
7. Verify returns to current month

**Practice Indicators:**

8. Look for green dots on calendar days
9. Verify dots appear on days with practices
10. Verify no dots on days without practices

**Day Selection:**

11. Click on a day with a practice
12. Verify sidebar/panel shows practice card(s)
13. Verify practice card displays:
    - Practice name
    - Time range
    - Status badge (Draft/Published)
14. Click on practice card
15. Verify navigates to practice detail page

**Visual Styling:**

16. Find a draft practice on calendar
17. Verify draft practice card has amber/yellow styling
18. Find a published practice
19. Verify published practice card has blue/green styling

**Season Filter (if applicable):**

20. Look for season filter dropdown
21. Select a different season
22. Verify calendar updates to show practices for that season

**Mobile Responsiveness:**

23. Open browser DevTools (F12)
24. Toggle device toolbar (mobile view)
25. Set viewport to phone size (e.g., 375px)
26. Verify calendar remains usable:
    - Days are tappable
    - Month navigation works
    - Day selection shows events
    - No horizontal scrolling required

**Multiple Events on Same Day:**

27. If you have multiple practices on same day:
28. Click that day
29. Verify all practices show in sidebar
30. Verify each can be clicked separately

**Expected Results:**
- [ ] Calendar displays current month correctly
- [ ] Month navigation (prev/next) works
- [ ] Green dots appear on days with practices
- [ ] Clicking day shows practice(s) in sidebar
- [ ] Practice cards show name, time, status
- [ ] Clicking card navigates to detail
- [ ] Draft practices have amber/yellow styling
- [ ] Published practices have blue/green styling
- [ ] Season filter works (if present)
- [ ] Calendar usable on mobile viewport
- [ ] Multiple events per day display correctly
  </how-to-verify>
  <resume-signal>Type "prac-05-passed" if all checks pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
## Summary Checklist

After all checkpoints pass:

| Requirement | Status | Notes |
|-------------|--------|-------|
| PRAC-01: Create practice with date/time | | |
| PRAC-02: Add blocks to practice | | |
| PRAC-03: Drag-drop athlete assignment | | |
| PRAC-04: Publish and athlete visibility | | |
| PRAC-05: Calendar readability | | |

## Known Limitations

Document any issues found but deemed acceptable:
- Location field not in schema (use notes field as workaround)
- Meeting blocks have minimal content (notes only - by design)
- Land assignments may use older UI in some views
</verification>

<success_criteria>
- All 5 checkpoint tasks pass human verification
- Coach can complete full practice creation flow
- Drag-drop lineup building works reliably
- Athletes see their assignments when practice is published
- Calendar provides clear visual indication of practices
</success_criteria>

<output>
After completion, create `.planning/phases/29-practice-flow-testing/29-01-SUMMARY.md` documenting test results with pass/fail for each requirement.
</output>
