---
phase: 35-device-specific
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/calendar/responsive-calendar-wrapper.tsx
  - src/components/calendar/unified-calendar.tsx
autonomous: true

must_haves:
  truths:
    - "User on mobile tapping date field sees calendar appear from bottom as a sheet"
    - "User can tap calendar dates without mis-taps (44px+ touch targets)"
  artifacts:
    - path: "src/components/calendar/responsive-calendar-wrapper.tsx"
      provides: "Mobile-aware calendar that renders in Drawer on small screens"
      exports: ["ResponsiveCalendarWrapper"]
    - path: "src/components/calendar/unified-calendar.tsx"
      provides: "Updated calendar with CSS variables for 44px touch targets"
      contains: "--rdp-day_button-height: 44px"
  key_links:
    - from: "src/components/calendar/unified-calendar.tsx"
      to: "ResponsiveCalendarWrapper"
      via: "Optional wrapper usage for date picker triggers"
      pattern: "ResponsiveCalendarWrapper|useIsMobile"
---

<objective>
Make calendar interactions mobile-optimized with bottom sheet presentation and touch-friendly targets.

Purpose: Users on mobile currently see the calendar inline, which takes too much space. The bottom sheet (Drawer) pattern is more native-feeling on iOS/Android. Additionally, date tap targets need to be 44px+ for reliable touch interaction.

Output: ResponsiveCalendarWrapper component for mobile date picker scenarios, and updated UnifiedCalendar with verified 44px touch targets via CSS variables.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/35-device-specific/35-RESEARCH.md

# Existing patterns to follow
@src/components/mobile/responsive-menu.tsx
@src/hooks/use-media-query.ts
@src/components/ui/drawer.tsx
@src/components/calendar/unified-calendar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ResponsiveCalendarWrapper component</name>
  <files>src/components/calendar/responsive-calendar-wrapper.tsx</files>
  <action>
Create a new component that wraps a date picker trigger and calendar content, rendering:
- On mobile (useIsMobile): Calendar inside a Drawer (bottom sheet)
- On desktop: Calendar inline or as a controlled popover (based on prop)

Follow the ResponsiveMenu pattern exactly:
1. Import useIsMobile from @/hooks/use-media-query
2. Import Drawer, DrawerContent, DrawerHeader, DrawerTitle, DrawerTrigger from @/components/ui/drawer
3. Use Popover components from shadcn/ui for desktop if inline=false

Props interface:
```typescript
interface ResponsiveCalendarWrapperProps {
  trigger: React.ReactNode;        // Button/input that opens calendar
  children: React.ReactNode;       // DayPicker or calendar content
  title?: string;                  // Optional title for mobile drawer header
  inline?: boolean;                // If true, desktop shows inline (default: false for popover)
  open?: boolean;                  // Controlled open state
  onOpenChange?: (open: boolean) => void;
}
```

Mobile behavior:
- Drawer opens from bottom with drag handle
- DrawerContent has `pb-safe` class for safe area (per Phase 32 decision)
- Calendar content renders with padding p-4

Desktop behavior (inline=false):
- Uses Popover from shadcn/ui
- PopoverContent aligns below trigger

Export both the component and a convenience hook useCalendarMode() that returns 'mobile' | 'desktop'.
  </action>
  <verify>
Run `npx tsc --noEmit` - no type errors for new component.
Grep for the component export: `grep -n "export function ResponsiveCalendarWrapper" src/components/calendar/responsive-calendar-wrapper.tsx`
  </verify>
  <done>
ResponsiveCalendarWrapper component exists with useIsMobile hook, renders Drawer on mobile and Popover on desktop.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add CSS variables for 44px calendar touch targets</name>
  <files>src/components/calendar/unified-calendar.tsx</files>
  <action>
Update the existing UnifiedCalendar component's inline styles to explicitly set react-day-picker v9 CSS variables for 44px touch targets.

The component already has 44px height set via `.calendar-day-btn { height: 44px }` but should also set the CSS variables for consistency with rdp internals:

In the existing `<style jsx global>` block, add at the top before `.calendar-day-btn`:

```css
/* Touch target sizing via CSS variables (react-day-picker v9) */
.rdp-root {
  --rdp-day_button-height: 44px;
  --rdp-day_button-width: 44px;
  --rdp-day-height: 48px;
  --rdp-day-width: 48px;
}
```

This ensures:
1. The CSS variables are set at the root level
2. Touch targets are 44px (WCAG 2.5.5 minimum)
3. Day cells have 48px for proper spacing

Also update the DayPicker classNames prop to add a wrapper class:
- Change `root: 'w-full'` to `root: 'w-full rdp-root'`

This is additive - don't remove the existing `.calendar-day-btn` styles.
  </action>
  <verify>
Run `grep -n "rdp-day_button-height: 44px" src/components/calendar/unified-calendar.tsx` - should find the CSS variable.
Run `grep -n "rdp-root" src/components/calendar/unified-calendar.tsx` - should find both the class and variable definitions.
  </verify>
  <done>
UnifiedCalendar has CSS variables set for 44px+ touch targets via --rdp-day_button-height and --rdp-day_button-width.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `npx tsc --noEmit`
2. ResponsiveCalendarWrapper exists with correct exports
3. UnifiedCalendar has rdp CSS variables for 44px touch targets
4. Both components import correctly when used
</verification>

<success_criteria>
- CALM-01: ResponsiveCalendarWrapper component created that shows Drawer on mobile
- CALM-02: Calendar touch targets are 44px+ via CSS variables
- No TypeScript errors
- Follows existing codebase patterns (ResponsiveMenu, useIsMobile)
</success_criteria>

<output>
After completion, create `.planning/phases/35-device-specific/35-01-SUMMARY.md`
</output>
